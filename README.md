# Credit-scoring
Аналитическая система на основе плоскослоистой нейронной сети прямого распространения для анализа кредитоспособности заемщика.

## Требования

Установленный интерпретатор [Python](https://www.python.org/downloads/), скачанный с официального сайта.

## Установка

1. В [releases](https://github.com/snikitin-de/Credit-scoring/releases) скачать архив с последней версии программы;
2. Распаковать архив;
3. В терминале:
   1. Ввести команду `cd %APP_PATH%` для перехода в папку с программой, где `%APP_PATH%` — путь до папки, в которую был распакован архив с программой;
   2. Ввести команду `pip install -r requirements.txt` для установки необходимых библиотек.

## Использование

Для выполнения программы необходимо в терминал ввести команду:

`python main.py`

# Пример

> **Примечание:** Данный пример показывает то. как пользоваться программой, он не содержит исходные наборы данных.

В качестве примера проанализируем следующие данные от заемщика:

| Имя поля                 | Значение |
|:-------------------------|---------:|
| Денежные средства        | 10000    |
| Ценные бумаги            | 10000    |
| Совокупные активы        | 5000     |
| Нетто-продажи            | 4750     |
| Брутто-доходы            | 5000     |
| Совокупная задолженность | 11850    |
| Основной капитал         | 17000    |
| Чистые активы            | 20000    |
| Оборотный капитал        | 18000    |

После запуска откроется главное окно программы:

![](images/main_window.png)

Алгоритм анализа кредитоспособности заемщика:

1. Ввести данные о заемщике в таблицу с исходными данными:

Для этого небходимо нажать правую кнопку мыши в поле таблицы (откроется контекстное меню):

![](images/initial_data_context_menu.png)

В появившемся меню следует выбрать пункт **Добавить строку** (пустая строка добавится в таблицу):

![](images/initial_data_added_row.png)

Далее введем информацию о заемщике из таблицы с исходными данными в программу:

![](images/initial_data_filled.png)

2. Настройка параметров нейронной сети:

После заполнения таблицы следует перейти на вкладку **Нейронная сеть** главного окна программы, для этого необходимо навести курсор мыши на вкладку
**Нейронная сеть** и нажать левую кнопку мыши (откроется вкладка **Нейронная сеть**):

![](images/neural_network.png)

С помощью переключателя выберем **Количество нейронов в скрытом слое**, к примеру, *6*. **Крутизну сигмоиды** оставим как есть. В поле для ввода **Обучающее
множество** введем *50*, в **Тестовое множество** — *25*, в **Количество эпох** — *5000*, в **Скорость обучения** – *0,1* и нажмем кнопку **Создать сеть**.

Настроенная нейронная сеть:

![](images/neural_network_tuned.png)

В результате создалась нейронная сеть и построился ее граф во вкладке **Граф нейросети**:

![](images/neural_network_graph.png)

3. Обучение нейронной сети:

Данные для обучения представляют собой рассчитанные коэффициенты для модели Чессера:

`Y = −2,0434 − 5,24 ∗ X1 + 0,0053 ∗ X2 − 6,6507 ∗ X3 + 4,4009 ∗ X4 − 0,0791 ∗ X5 − 0,1220 ∗ X6`, где

* **X1** — (денежные средства + быстрореализуемые ценные бумаги) / совокупные
активы;
* **X2** — нетто-продажи / (денежные средства + быстрореализуемые ценные
бумаги);
* **X3** — брутто-доходы / совокупные активы;
* **X4** — совокупная задолженность / совокупные активы;
* **X5** — основной капитал / чистые активы;
* **X6** — оборотный капитал / нетто-продажи.

Для загрузки обучающих данных в программу необходимо навести курсор мыши на пункт меню **Файл**, затем нажать левую кнопку мыши. В открывшемся меню следует выбрать пункт меню **Загрузить данные для обучения…** Далее следует выбрать какой тип файла загрузить (*.txt) или (*.csv). Для примера выберем CSV-файл (пункт меню **Загрузить из CSV-файла**), как показано на рисунке:

![](images/file_context_menu.png)

После выбора файла с данными для обучения он загрузится в таблицу:

![](images/neural_network_loaded_data.png)

Затем следует нажать на кнопку **Обучить** и нейронная сеть начнет обучаться:

![](images/neural_network_training.png)

Результат обучения представлен на рисунке:

![](images/neural_network_trained.png)

Графики сигмоиды и величины ошибки показаны на рисунке:

![](images/neural_network_training_graph.png)

4. Сохранение и загрузка нейронной сети:

В программе можно сохранить хорошо обученную сеть для дальнейшего использования. Для этого необходимо навести курсор на пункт меню **Нейронная сеть** и в открывшемся меню выбрать пункт **Сохранить сеть**, либо сохранить сеть можно с помощью сочетаний клавиш `Ctrl+K`. 

Пример файла конфигурации приведен на рисунке:

![](images/configuration_file.png)

В данном файле сохраняются все необходимые данные для создания сети, а именно:
  * Число скрытых нейронов;
  * Кривизна сигмоиды;
  * Размер обучающего и тестового множества;
  * Количество эпох;
  * Скорость обучения;
  * Веса всех связей нейронов.

Для загрузки файла конфигурации нейронной сети, необходимо навести на пункт меню **Нейронная сеть**, в появившемся меню выбрать пункт **Загрузить сеть** или нажать сочетание клавиш `Ctrl+L`.

5. Результаты предсказания кредитоспособности заемщика:

После обучения следует вернуться на вкладку **Исходные данные** и открыть контекстное меню таблицы. В открывшемся меню необходимо выбрать пункт **Результаты (таблица)**, если в таблице множество строк, а чтобы получить результат предсказания для одной строки, как в нашем случае, необходимо выделить ее левой кнопкой мыши, затем нажать правую кнопку мыши и в открывшемся меню выбрать пункт **Результаты (строка)**. В поле **Результат** отобразится результат предсказания кредитоспособности заемщика, если в данном поле будет значение **Кредитоспособно**, то заемщик с высокой долью вероятности вернет кредит, если **Не кредитоспособно**, то заемщик кредит скорее всего не вернет.

![](images/neural_network_prediction_result.png)
